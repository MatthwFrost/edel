/*! For license information please see inject.js.LICENSE.txt */
(()=>{"use strict";class t{constructor(){this._vector=new Float32Array,this._position=0,this._frameCount=0}get vector(){return this._vector}get position(){return this._position}get startIndex(){return 2*this._position}get frameCount(){return this._frameCount}get endIndex(){return 2*(this._position+this._frameCount)}clear(){this.receive(this._frameCount),this.rewind()}put(t){this._frameCount+=t}putSamples(t,e,r=0){const n=2*(e=e||0);r>=0||(r=(t.length-n)/2);const i=2*r;this.ensureCapacity(r+this._frameCount);const o=this.endIndex;this.vector.set(t.subarray(n,n+i),o),this._frameCount+=r}putBuffer(t,e,r=0){e=e||0,r>=0||(r=t.frameCount-e),this.putSamples(t.vector,t.position+e,r)}receive(t){t>=0&&!(t>this._frameCount)||(t=this.frameCount),this._frameCount-=t,this._position+=t}receiveSamples(t,e=0){const r=2*e,n=this.startIndex;t.set(this._vector.subarray(n,n+r)),this.receive(e)}extract(t,e=0,r=0){const n=this.startIndex+2*e,i=2*r;t.set(this._vector.subarray(n,n+i))}ensureCapacity(t=0){const e=parseInt(2*t);if(this._vector.length<e){const t=new Float32Array(e);t.set(this._vector.subarray(this.startIndex,this.endIndex)),this._vector=t,this._position=0}else this.rewind()}ensureAdditionalCapacity(t=0){this.ensureCapacity(this._frameCount+t)}rewind(){this._position>0&&(this._vector.set(this._vector.subarray(this.startIndex,this.endIndex)),this._position=0)}}class e{constructor(e){e?(this._inputBuffer=new t,this._outputBuffer=new t):this._inputBuffer=this._outputBuffer=null}get inputBuffer(){return this._inputBuffer}set inputBuffer(t){this._inputBuffer=t}get outputBuffer(){return this._outputBuffer}set outputBuffer(t){this._outputBuffer=t}clear(){this._inputBuffer.clear(),this._outputBuffer.clear()}}class r extends e{constructor(t){super(t),this.reset(),this._rate=1}set rate(t){this._rate=t}reset(){this.slopeCount=0,this.prevSampleL=0,this.prevSampleR=0}clone(){const t=new r;return t.rate=this._rate,t}process(){const t=this._inputBuffer.frameCount;this._outputBuffer.ensureAdditionalCapacity(t/this._rate+1);const e=this.transpose(t);this._inputBuffer.receive(),this._outputBuffer.put(e)}transpose(t=0){if(0===t)return 0;const e=this._inputBuffer.vector,r=this._inputBuffer.startIndex,n=this._outputBuffer.vector,i=this._outputBuffer.endIndex;let o=0,s=0;for(;this.slopeCount<1;)n[i+2*s]=(1-this.slopeCount)*this.prevSampleL+this.slopeCount*e[r],n[i+2*s+1]=(1-this.slopeCount)*this.prevSampleR+this.slopeCount*e[r+1],s+=1,this.slopeCount+=this._rate;if(this.slopeCount-=1,1!==t)t:for(;;){for(;this.slopeCount>1;)if(this.slopeCount-=1,o+=1,o>=t-1)break t;const a=r+2*o;n[i+2*s]=(1-this.slopeCount)*e[a]+this.slopeCount*e[a+2],n[i+2*s+1]=(1-this.slopeCount)*e[a+1]+this.slopeCount*e[a+3],s+=1,this.slopeCount+=this._rate}return this.prevSampleL=e[r+2*t-2],this.prevSampleR=e[r+2*t-1],s}}class n{constructor(t){this._pipe=t}get pipe(){return this._pipe}get inputBuffer(){return this._pipe.inputBuffer}get outputBuffer(){return this._pipe.outputBuffer}fillInputBuffer(){throw new Error("fillInputBuffer() not overridden")}fillOutputBuffer(t=0){for(;this.outputBuffer.frameCount<t;){const t=16384-this.inputBuffer.frameCount;if(this.fillInputBuffer(t),this.inputBuffer.frameCount<16384)break;this._pipe.process()}}clear(){this._pipe.clear()}}const i=function(){};class o extends n{constructor(t,e,r=i){super(e),this.callback=r,this.sourceSound=t,this.historyBufferSize=22050,this._sourcePosition=0,this.outputBufferPosition=0,this._position=0}get position(){return this._position}set position(t){if(t>this._position)throw new RangeError("New position may not be greater than current position");const e=this.outputBufferPosition-(this._position-t);if(e<0)throw new RangeError("New position falls outside of history buffer");this.outputBufferPosition=e,this._position=t}get sourcePosition(){return this._sourcePosition}set sourcePosition(t){this.clear(),this._sourcePosition=t}onEnd(){this.callback()}fillInputBuffer(t=0){const e=new Float32Array(2*t),r=this.sourceSound.extract(e,t,this._sourcePosition);this._sourcePosition+=r,this.inputBuffer.putSamples(e,0,r)}extract(t,e=0){this.fillOutputBuffer(this.outputBufferPosition+e);const r=Math.min(e,this.outputBuffer.frameCount-this.outputBufferPosition);this.outputBuffer.extract(t,this.outputBufferPosition,r);const n=this.outputBufferPosition+r;return this.outputBufferPosition=Math.min(this.historyBufferSize,n),this.outputBuffer.receive(Math.max(n-this.historyBufferSize,0)),this._position+=r,r}handleSampleData(t){this.extract(t.data,4096)}clear(){super.clear(),this.outputBufferPosition=0}}const s=[[124,186,248,310,372,434,496,558,620,682,744,806,868,930,992,1054,1116,1178,1240,1302,1364,1426,1488,0],[-100,-75,-50,-25,25,50,75,100,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-20,-15,-10,-5,5,10,15,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-4,-3,-2,-1,1,2,3,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]];class a extends e{constructor(t){super(t),this._quickSeek=!0,this.midBufferDirty=!1,this.midBuffer=null,this.overlapLength=0,this.autoSeqSetting=!0,this.autoSeekSetting=!0,this._tempo=1,this.setParameters(44100,0,0,8)}clear(){super.clear(),this.clearMidBuffer()}clearMidBuffer(){this.midBufferDirty&&(this.midBufferDirty=!1,this.midBuffer=null)}setParameters(t,e,r,n){t>0&&(this.sampleRate=t),n>0&&(this.overlapMs=n),e>0?(this.sequenceMs=e,this.autoSeqSetting=!1):this.autoSeqSetting=!0,r>0?(this.seekWindowMs=r,this.autoSeekSetting=!1):this.autoSeekSetting=!0,this.calculateSequenceParameters(),this.calculateOverlapLength(this.overlapMs),this.tempo=this._tempo}set tempo(t){let e;this._tempo=t,this.calculateSequenceParameters(),this.nominalSkip=this._tempo*(this.seekWindowLength-this.overlapLength),this.skipFract=0,e=Math.floor(this.nominalSkip+.5),this.sampleReq=Math.max(e+this.overlapLength,this.seekWindowLength)+this.seekLength}get tempo(){return this._tempo}get inputChunkSize(){return this.sampleReq}get outputChunkSize(){return this.overlapLength+Math.max(0,this.seekWindowLength-2*this.overlapLength)}calculateOverlapLength(t=0){let e;e=this.sampleRate*t/1e3,e=e<16?16:e,e-=e%8,this.overlapLength=e,this.refMidBuffer=new Float32Array(2*this.overlapLength),this.midBuffer=new Float32Array(2*this.overlapLength)}checkLimits(t,e,r){return t<e?e:t>r?r:t}calculateSequenceParameters(){let t,e;this.autoSeqSetting&&(t=150+-50*this._tempo,t=this.checkLimits(t,50,125),this.sequenceMs=Math.floor(t+.5)),this.autoSeekSetting&&(e=28.333333333333332+-6.666666666666667*this._tempo,e=this.checkLimits(e,15,25),this.seekWindowMs=Math.floor(e+.5)),this.seekWindowLength=Math.floor(this.sampleRate*this.sequenceMs/1e3),this.seekLength=Math.floor(this.sampleRate*this.seekWindowMs/1e3)}set quickSeek(t){this._quickSeek=t}clone(){const t=new a;return t.tempo=this._tempo,t.setParameters(this.sampleRate,this.sequenceMs,this.seekWindowMs,this.overlapMs),t}seekBestOverlapPosition(){return this._quickSeek?this.seekBestOverlapPositionStereoQuick():this.seekBestOverlapPositionStereo()}seekBestOverlapPositionStereo(){let t,e,r,n=0;for(this.preCalculateCorrelationReferenceStereo(),t=0,e=Number.MIN_VALUE;n<this.seekLength;n+=1)r=this.calculateCrossCorrelationStereo(2*n,this.refMidBuffer),r>e&&(e=r,t=n);return t}seekBestOverlapPositionStereoQuick(){let t,e,r,n,i,o=0;for(this.preCalculateCorrelationReferenceStereo(),e=Number.MIN_VALUE,t=0,n=0,i=0;o<4;o+=1){let a=0;for(;s[o][a]&&(i=n+s[o][a],!(i>=this.seekLength));)r=this.calculateCrossCorrelationStereo(2*i,this.refMidBuffer),r>e&&(e=r,t=i),a+=1;n=t}return t}preCalculateCorrelationReferenceStereo(){let t,e,r=0;for(;r<this.overlapLength;r+=1)e=r*(this.overlapLength-r),t=2*r,this.refMidBuffer[t]=this.midBuffer[t]*e,this.refMidBuffer[t+1]=this.midBuffer[t+1]*e}calculateCrossCorrelationStereo(t,e){const r=this._inputBuffer.vector;t+=this._inputBuffer.startIndex;let n=0,i=2;const o=2*this.overlapLength;let s;for(;i<o;i+=2)s=i+t,n+=r[s]*e[i]+r[s+1]*e[i+1];return n}overlap(t){this.overlapStereo(2*t)}overlapStereo(t){const e=this._inputBuffer.vector;t+=this._inputBuffer.startIndex;const r=this._outputBuffer.vector,n=this._outputBuffer.endIndex;let i,o,s=0;const a=1/this.overlapLength;let u,c,h;for(;s<this.overlapLength;s+=1)o=(this.overlapLength-s)*a,u=s*a,i=2*s,c=i+t,h=i+n,r[h+0]=e[c+0]*u+this.midBuffer[i+0]*o,r[h+1]=e[c+1]*u+this.midBuffer[i+1]*o}process(){let t,e,r;if(null===this.midBuffer){if(this._inputBuffer.frameCount<this.overlapLength)return;this.midBuffer=new Float32Array(2*this.overlapLength),this._inputBuffer.receiveSamples(this.midBuffer,this.overlapLength)}for(;this._inputBuffer.frameCount>=this.sampleReq;){t=this.seekBestOverlapPosition(),this._outputBuffer.ensureAdditionalCapacity(this.overlapLength),this.overlap(Math.floor(t)),this._outputBuffer.put(this.overlapLength),e=this.seekWindowLength-2*this.overlapLength,e>0&&this._outputBuffer.putBuffer(this._inputBuffer,t+this.overlapLength,e);const n=this._inputBuffer.startIndex+2*(t+this.seekWindowLength-this.overlapLength);this.midBuffer.set(this._inputBuffer.vector.subarray(n,n+2*this.overlapLength)),this.skipFract+=this.nominalSkip,r=Math.floor(this.skipFract),this.skipFract-=r,this._inputBuffer.receive(r)}}}const u=function(t,e){return(t>e?t-e:e-t)>1e-10};class c{constructor(){this.transposer=new r(!1),this.stretch=new a(!1),this._inputBuffer=new t,this._intermediateBuffer=new t,this._outputBuffer=new t,this._rate=0,this._tempo=0,this.virtualPitch=1,this.virtualRate=1,this.virtualTempo=1,this.calculateEffectiveRateAndTempo()}clear(){this.transposer.clear(),this.stretch.clear()}clone(){const t=new c;return t.rate=this.rate,t.tempo=this.tempo,t}get rate(){return this._rate}set rate(t){this.virtualRate=t,this.calculateEffectiveRateAndTempo()}set rateChange(t){this._rate=1+.01*t}get tempo(){return this._tempo}set tempo(t){this.virtualTempo=t,this.calculateEffectiveRateAndTempo()}set tempoChange(t){this.tempo=1+.01*t}set pitch(t){this.virtualPitch=t,this.calculateEffectiveRateAndTempo()}set pitchOctaves(t){this.pitch=Math.exp(.69314718056*t),this.calculateEffectiveRateAndTempo()}set pitchSemitones(t){this.pitchOctaves=t/12}get inputBuffer(){return this._inputBuffer}get outputBuffer(){return this._outputBuffer}calculateEffectiveRateAndTempo(){const t=this._tempo,e=this._rate;this._tempo=this.virtualTempo/this.virtualPitch,this._rate=this.virtualRate*this.virtualPitch,u(this._tempo,t)&&(this.stretch.tempo=this._tempo),u(this._rate,e)&&(this.transposer.rate=this._rate),this._rate>1?this._outputBuffer!=this.transposer.outputBuffer&&(this.stretch.inputBuffer=this._inputBuffer,this.stretch.outputBuffer=this._intermediateBuffer,this.transposer.inputBuffer=this._intermediateBuffer,this.transposer.outputBuffer=this._outputBuffer):this._outputBuffer!=this.stretch.outputBuffer&&(this.transposer.inputBuffer=this._inputBuffer,this.transposer.outputBuffer=this._intermediateBuffer,this.stretch.inputBuffer=this._intermediateBuffer,this.stretch.outputBuffer=this._outputBuffer)}process(){this._rate>1?(this.stretch.process(),this.transposer.process()):(this.transposer.process(),this.stretch.process())}}class h{constructor(t){this.buffer=t,this._position=0}get dualChannel(){return this.buffer.numberOfChannels>1}get position(){return this._position}set position(t){this._position=t}extract(t,e=0,r=0){this.position=r;let n=this.buffer.getChannelData(0),i=this.dualChannel?this.buffer.getChannelData(1):this.buffer.getChannelData(0),o=0;for(;o<e;o++)t[2*o]=n[o+r],t[2*o+1]=i[o+r];return Math.min(e,n.length-r)}}const l=function(t){const e=Math.floor(t/60);return`${e}:${r=parseInt(t-60*e),2,n=n||"0",(r+="").length>=2?r:new Array(2-r.length+1).join(n)+r}`;var r,n},f=function(t){const e=this.timePlayed,r=this.sampleRate;if(this.sourcePosition=t,this.timePlayed=t/r,e!==this.timePlayed){const t=new CustomEvent("play",{detail:{timePlayed:this.timePlayed,formattedTimePlayed:this.formattedTimePlayed,percentagePlayed:this.percentagePlayed}});this._node.dispatchEvent(t)}};class p{constructor(t,e,r,n=i){this._soundtouch=new c;const s=new h(e);this.timePlayed=0,this.sourcePosition=0,this._filter=new o(s,this._soundtouch,n),this._node=function(t,e,r=i,n=4096){const o=t.createScriptProcessor(n,2,2),s=new Float32Array(2*n);return o.onaudioprocess=t=>{let i=t.outputBuffer.getChannelData(0),o=t.outputBuffer.getChannelData(1),a=e.extract(s,n);r(e.sourcePosition),0===a&&e.onEnd();let u=0;for(;u<a;u++)i[u]=s[2*u],o[u]=s[2*u+1]},o}(t,this._filter,(t=>f.call(this,t)),r),this.tempo=1,this.rate=1,this.duration=e.duration,this.sampleRate=t.sampleRate,this.listeners=[]}get formattedDuration(){return l(this.duration)}get formattedTimePlayed(){return l(this.timePlayed)}get percentagePlayed(){return 100*this._filter.sourcePosition/(this.duration*this.sampleRate)}set percentagePlayed(t){this._filter.sourcePosition=parseInt(t*this.duration*this.sampleRate),this.sourcePosition=this._filter.sourcePosition,this.timePlayed=this.sourcePosition/this.sampleRate}get node(){return this._node}set pitch(t){this._soundtouch.pitch=t}set pitchSemitones(t){this._soundtouch.pitchSemitones=t}set rate(t){this._soundtouch.rate=t}set tempo(t){this._soundtouch.tempo=t}connect(t){this._node.connect(t)}disconnect(){this._node.disconnect()}on(t,e){this.listeners.push({name:t,cb:e}),this._node.addEventListener(t,(t=>e(t.detail)))}off(t=null){let e=this.listeners;t&&(e=e.filter((e=>e.name===t))),e.forEach((t=>{this._node.removeEventListener(t.name,(e=>t.cb(e.detail)))}))}}function d(t){return d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},d(t)}function m(){m=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof w?e:w,s=Object.create(o.prototype),a=new I(n||[]);return i(s,"_invoke",{value:C(t,r,a)}),s}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",y="executing",v="completed",g={};function w(){}function b(){}function _(){}var k={};c(k,s,(function(){return this}));var x=Object.getPrototypeOf,B=x&&x(x(R([])));B&&B!==r&&n.call(B,s)&&(k=B);var S=_.prototype=w.prototype=Object.create(k);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(i,o,s,a){var u=l(t[i],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==d(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,a)}),(function(t){r("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return r("throw",t,s,a)}))}a(u.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,r,n){var i=f;return function(o,s){if(i===y)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var u=E(a,n);if(u){if(u===g)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=y;var c=l(e,r,n);if("normal"===c.type){if(i=n.done?v:p,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=v,n.method="throw",n.arg=c.arg)}}}function E(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=l(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(d(e)+" is not iterable")}return b.prototype=_,i(S,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:b,configurable:!0}),b.displayName=c(_,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,c(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},L(P.prototype),c(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new P(h(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},L(S),c(S,u,"Generator"),c(S,s,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:R(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function y(t,e,r,n,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}function v(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function s(t){y(o,n,i,s,a,"next",t)}function a(t){y(o,n,i,s,a,"throw",t)}s(void 0)}))}}function g(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,w(n.key),n)}}function w(t){var e=function(t,e){if("object"!=d(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!=d(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==d(e)?e:e+""}var b=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.init()},e=[{key:"init",value:(c=v(m().mark((function t(){var e;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("Audio context is initialized"),this.bufferQueue=[],this.currentBufferIndex=0,this.currentDuration=0,this.currentSentence="",this.bufferElapsedTime=0,this.isPlaying=!1,this.isPaused=!1,this.audioCtx=new(window.AudioContext||window.webkitAudioContext),this.gainNode=this.audioCtx.createGain(),this.shifter=null,this.tempo=1,this.pitch=1,this.playOnAudioEndTimeout=0,this.preFetchTimeout=0,this.resumeTimeout=0,this.skipped=!1,t.next=19,this.getPlaybackAndVolume();case 19:e=t.sent,this.tempo=e.playbackRate,this.volumeValue=e.volumeValue,console.log(this.volumeValue,this.tempo),this.gainNode.gain.value=parseFloat(this.volumeValue);case 24:case"end":return t.stop()}}),t,this)}))),function(){return c.apply(this,arguments)})},{key:"startPlaybackCycle",value:(u=v(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.setLoadingCursor(!0),t.next=3,this.getUser();case 3:if(t.sent){t.next=10;break}return alert("Please sign in to use Readel."),this.setLoadingCursor(!1),t.abrupt("return");case 10:this.sentences=e,this.currentSentenceIndex=0,this.preloadAudio(this.sentences[this.currentSentenceIndex]),this.currentSentenceIndex++,this.setLoadingCursor(!1);case 15:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"preloadAudio",value:(a=v(m().mark((function t(e){var r,n,i,o;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.currentSentence=e,t.next=3,this.fetchVoiceAndQualitySettings();case 3:return r=t.sent,n=r.voice,i=r.quality,o="https://x6oh96vkd8.execute-api.eu-central-1.amazonaws.com/fetchAudioAPI/fetchAudio?sentence=".concat(encodeURIComponent(e),"&index=").concat(this.currentBufferIndex,"&voice=").concat(n,"&quality=").concat(i),t.next=9,this.fetchAndDecodeAudio(o);case 9:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"fetchAndDecodeAudio",value:(s=v(m().mark((function t(e){var r,n,i,o=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch(e);case 3:if((r=t.sent).ok){t.next=6;break}throw new Error("HTTP error! Status: ".concat(r.status));case 6:return t.next=8,r.json();case 8:if((n=t.sent).audioBase64){t.next=11;break}throw new Error("No audio data found in the response");case 11:i=this.base64ToArrayBuffer(n.audioBase64),console.log("Array buffer fetched: ",i),this.audioCtx.decodeAudioData(i,(function(t){o.bufferQueue.push(t),o.isPlaying||o.isPaused||o.play()})),t.next=20;break;case 16:throw t.prev=16,t.t0=t.catch(0),console.error("Failed to fetch or decode audio:",t.t0),t.t0;case 20:case"end":return t.stop()}}),t,this,[[0,16]])}))),function(t){return s.apply(this,arguments)})},{key:"play",value:(o=v(m().mark((function t(){var e,r=this;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.isPaused){t.next=2;break}return t.abrupt("return");case 2:this.bufferQueue.length>0&&!this.isPaused?(console.log("Sentence loaded: ",this.currentSentence),e=this.bufferQueue.shift(),this.shifter=new p(this.audioCtx,e,16384),this.shifter.tempo=this.tempo,this.shifter.pitch=this.pitch,this.currentDuration=e.duration,this.isPlaying=!0,this.isPaused=!1,this.preFetchTimeout=setTimeout((function(){console.log("audio next audio buffer loaded"),r.isPaused?console.log("Audio is paused."):(r.preloadAudio(r.sentences[r.currentSentenceIndex]),r.currentSentenceIndex<r.sentences.length-1?r.currentSentenceIndex++:console.log("Reached the end of sentences"))}),800*e.duration/this.tempo),this.playOnAudioEndTimeout=setTimeout(v(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r.isPaused||(console.log("PLAYING NEW AUDIO"),r.isPlaying=!1,r.decideNextStep());case 1:case"end":return t.stop()}}),t)}))),1e3*e.duration/this.tempo+100),this.setCharacter(this.currentSentence.length).catch((function(t){console.error("Failed to set character:",t)})),this.shifter.connect(this.gainNode),this.gainNode.connect(this.audioCtx.destination),console.log("resuming the audio"),this.audioCtx.resume()):console.log("Queue is empty, waiting for more audio");case 3:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"setPlaybackRate",value:function(t){this.playbackRate=t,this.shifter&&(this.shifter.tempo=this.playbackRate),this.tempo=this.playbackRate,console.log("Playback rate set to ",this.playbackRate)}},{key:"decideNextStep",value:function(){!this.isPaused&&this.bufferQueue.length>0?this.play():this.handleAudioEnded()}},{key:"pause",value:function(){this.audioCtx.suspend(),this.bufferElapsedTime=this.currentDuration-this.shifter.timePlayed,this.isPaused=!0,this.isPlaying=!1,clearTimeout(this.playOnAudioEndTimeout),clearTimeout(this.preFetchTimeout),clearTimeout(this.resumeTimeout)}},{key:"resume",value:function(){var t=this;!this.isPlaying&&this.isPaused&&(this.audioCtx.resume(),this.isPaused=!1,this.isPlaying=!0,this.resumeTimeout=setTimeout((function(){t.isPaused||(console.log("PLAYING NEW AUDIO FROM RESUME"),t.isPlaying=!1,t.decideNextStep())}),1e3*this.bufferElapsedTime))}},{key:"reset",value:function(){this.pause(),this.audioCtx.suspend(),this.init(),clearTimeout(this.playOnAudioEndTimeout),clearTimeout(this.preFetchTimeout),clearTimeout(this.resumeTimeout)}},{key:"setVolume",value:function(t){this.volumeValue=t,this.gainNode.gain.value=this.volumeValue}},{key:"skipForward",value:function(){this.currentSentenceIndex<this.sentences.length?(this.stop(),this.preloadAudio(this.sentences[this.currentSentenceIndex]),this.currentSentenceIndex++):console.log("Reached the end of the playlist")}},{key:"skipBackward",value:function(){this.currentSentenceIndex>0?(this.stop(),this.currentSentenceIndex--,this.preloadAudio(this.sentences[this.currentSentenceIndex])):console.log("Already at the beginning of the playlist")}},{key:"stop",value:function(){this.shifter&&this.shifter.disconnect(),this.audioCtx.suspend(),this.isPlaying=!1,this.isPaused=!1,clearTimeout(this.playOnAudioEndTimeout),clearTimeout(this.preFetchTimeout),clearTimeout(this.resumeTimeout)}},{key:"handleAudioEnded",value:function(){console.log("Audio ended or skipped, checking for more..."),this.bufferQueue.length>0?this.play():this.currentSentenceIndex<this.sentences.length?(this.preloadAudio(this.sentences[this.currentSentenceIndex]),this.currentSentenceIndex++):console.log("All audio has been played or is at the end of the queue")}},{key:"fetchVoiceAndQualitySettings",value:(i=v(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.storage.local.get(["voiceID","qualityID"],(function(e){var r=e.voiceID||"robert",n=e.qualityID||"high";t({voice:r,quality:n})}))})));case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"getPlaybackAndVolume",value:function(){var t=v(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.storage.local.get(["volumeValue","playbackRate"],(function(e){var r=e.volumeValue||.5,n=e.playbackRate||1;t({volumeValue:r,playbackRate:n})}))})));case 1:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()},{key:"base64ToArrayBuffer",value:function(t){for(var e=window.atob(t),r=e.length,n=new Uint8Array(r),i=0;i<r;i++)n[i]=e.charCodeAt(i);return n.buffer}},{key:"setLoadingCursor",value:function(t){if(t){var e=document.createElement("style");e.id="corsor_wait",e.innerHTML="* {cursor: wait;}",document.head.insertBefore(e,null)}else document.getElementById("corsor_wait").remove()}},{key:"setCharacter",value:(n=v(m().mark((function t(e){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:chrome.storage.sync.get("user",function(){var t=v(m().mark((function t(r){var n,i,o;return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!chrome.runtime.lastError){t.next=3;break}return console.error(chrome.runtime.lastError),t.abrupt("return");case 3:if(void 0!==r.user){t.next=5;break}return t.abrupt("return");case 5:return console.log(r.user),n="https://82p6i611i7.execute-api.eu-central-1.amazonaws.com/dev/setCharacters?user=".concat(r.user,"&updateChar=").concat(e),t.prev=7,t.next=10,fetch(n,{method:"GET",headers:{Authorization:"Bearer ".concat(r)}});case 10:return i=t.sent,t.next=13,i.json();case 13:o=t.sent,console.log(o),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(7),console.error("Error fetching user info:",t.t0);case 20:case"end":return t.stop()}}),t,null,[[7,17]])})));return function(e){return t.apply(this,arguments)}}());case 1:case"end":return t.stop()}}),t)}))),function(t){return n.apply(this,arguments)})},{key:"getUser",value:(r=v(m().mark((function t(){return m().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.storage.sync.get("user",function(){var e=v(m().mark((function e(r){return m().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:void 0===r.user&&(alert("Oh no, you are not signed in! Click on 'Readel' in the Extensions tab to sign in."),t({return:!1})),chrome.runtime.lastError&&(console.error(chrome.runtime.lastError),t({return:!1}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),t({return:!0})})));case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&g(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,i,o,s,a,u,c}();const _=b;function k(t){return k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},k(t)}function x(){x=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof v?e:v,s=Object.create(o.prototype),a=new I(n||[]);return i(s,"_invoke",{value:C(t,r,a)}),s}function l(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var f="suspendedStart",p="suspendedYield",d="executing",m="completed",y={};function v(){}function g(){}function w(){}var b={};c(b,s,(function(){return this}));var _=Object.getPrototypeOf,B=_&&_(_(R([])));B&&B!==r&&n.call(B,s)&&(b=B);var S=w.prototype=v.prototype=Object.create(b);function L(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function P(t,e){function r(i,o,s,a){var u=l(t[i],t,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==k(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,a)}),(function(t){r("throw",t,s,a)})):e.resolve(h).then((function(t){c.value=t,s(c)}),(function(t){return r("throw",t,s,a)}))}a(u.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function C(e,r,n){var i=f;return function(o,s){if(i===d)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var u=E(a,n);if(u){if(u===y)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===f)throw i=m,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=d;var c=l(e,r,n);if("normal"===c.type){if(i=n.done?m:p,c.arg===y)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=m,n.method="throw",n.arg=c.arg)}}}function E(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,E(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var o=l(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,y;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function A(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(A,this),this.reset(!0)}function R(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(k(e)+" is not iterable")}return g.prototype=w,i(S,"constructor",{value:w,configurable:!0}),i(w,"constructor",{value:g,configurable:!0}),g.displayName=c(w,u,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,w):(t.__proto__=w,c(t,u,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},L(P.prototype),c(P.prototype,a,(function(){return this})),e.AsyncIterator=P,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new P(h(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},L(S),c(S,u,"Generator"),c(S,s,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=R,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var u=n.call(s,"catchLoc"),c=n.call(s,"finallyLoc");if(u&&c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,y):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;T(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:R(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function B(t,e,r,n,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}function S(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function s(t){B(o,n,i,s,a,"next",t)}function a(t){B(o,n,i,s,a,"throw",t)}s(void 0)}))}}function L(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function P(){return(P=S(x().mark((function t(e){var r,n,i,o,s,a,u,c;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return c=function(t){r.mainContainer.style.width=t?"250px":"125px",r.settingsContainer.style.width=t?"40%":"70%",r.playerContainer.style.width=t?"60%":"30%",r.playButton.innerHTML=t?'<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="#fff" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-pause"><rect x="6" y="4" width="4" height="16"/><rect x="14" y="4" width="4" height="16"/></svg>':'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="#fff" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-play"><polygon points="5 3 19 12 5 21 5 3"/></svg>',setTimeout((function(){r.forwardButton.hidden=!r.forwardButton.hidden,r.backwardButton.hidden=!r.backwardButton.hidden,r.resetButton.hidden=!r.resetButton.hidden}),t?500:0),chrome.runtime.sendMessage({action:t})},r=O(e),t.next=4,E();case 4:n=t.sent,i=n.volumeValue,o=n.playbackRate,console.log(i,o),r.volumeRange.value=i,r.playbackButton.textContent=o+"x",a=!1,u=!1,s=new _,r.playButton.addEventListener("click",(function(){if(c(a=!a),a)if(u)s.resume(),console.log("resuming...");else{var t=R(T());s.startPlaybackCycle(t),console.log("playing..."),u=!0}else s.pause(),console.log("pausing...")})),r.backwardButton.addEventListener("click",(function(){s.skipBackward()})),r.forwardButton.addEventListener("click",(function(){s.skipForward()})),r.resetButton.addEventListener("click",(function(){u=!1,a=!1,c(!1),s.reset()})),r.volumeRange.addEventListener("input",(function(){s&&s.setVolume(this.value),chrome.storage.local.set({volumeValue:this.value})})),r.playbackContainer.addEventListener("click",(function(t){console.log("Click detected within shadow DOM");var e=t.target.closest(".dropdown-menu-link");if(e){t.preventDefault();var n=e.getAttribute("data-id");console.log("Selected playback rate:",n),s&&(s.setPlaybackRate(parseFloat(n)),console.log("player is going")),r.playbackButton.textContent=n+"x",chrome.storage.local.set({playbackRate:n})}})),C(e),chrome.runtime.onMessage.addListener((function(t){if("clicked"===t.greeting)if(a=!0,c(!0),a)if(u)s.resume(),console.log("resuming...");else{var e=window.getSelection().toString().trim(),r=I(T(),e);s.startPlaybackCycle(r),console.log("playing..."),u=!0}else s.pause(),console.log("pausing...");else"stop"===t.greeting?(a=!1,c(!1),s.pause()):"out"===t.greeting?alert("Readel has ran out of characters"):"error"===t.install?alert("There has been an error with you install. Please contact our support."):"userInfoError"===t.error&&alert("Please sign in to use Readel.")}));case 21:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(t){t.addEventListener("click",(function(e){var r,n=e.target.matches("[data-dropdown-button]");(n||null==e.target.closest("[data-dropdown]"))&&(n&&(r=e.target.closest("[data-dropdown]")).classList.toggle("active"),t.querySelectorAll("[data-dropdown].active").forEach((function(t){t!==r&&t.classList.remove("active")})))}))}function E(){return A.apply(this,arguments)}function A(){return(A=S(x().mark((function t(){return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){chrome.storage.local.get(["volumeValue","playbackRate"],(function(e){var r=e.volumeValue||.5,n=e.playbackRate||1;t({volumeValue:r,playbackRate:n})}))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function T(){var t=document.querySelector("article"),e="";return t?e=t.innerText:["h1","p","li"].forEach((function(t){document.querySelectorAll(t).forEach((function(t){e+=t.innerText+" "}))})),e.trim()}function I(t,e){var r=t.indexOf(e);return-1===r?(console.log("Selected text not found in the main body of the text."),R(e)):R(t.slice(r))}function R(t){var e=t.match(/[^.;:\n!?]+[.;:\n!?]+/g)||[];return e.map((function(t){return t.trim()}))}function O(t){return{audioContainer:t.querySelector("#audio-container"),mainContainer:t.querySelector("#main-container"),settingsContainer:t.querySelector("#settings-container"),playerContainer:t.querySelector("#player-container"),playerContainerChild:t.querySelector("#player-container-child"),playButton:t.querySelector("#player-button"),forwardButton:t.querySelector("#fskip-button"),backwardButton:t.querySelector("#bskip-button"),resetButton:t.querySelector("#reset-button"),playbackContainer:t.querySelector("#playback-rate-selector"),playbackButton:t.querySelector("#playback-rate"),volumeRange:t.getElementById("volume-range")}}var M,j;M=chrome.runtime.getURL("scripts/style/injectedContent.html"),j=chrome.runtime.getURL("scripts/style/elementStyle.css"),Promise.all([fetch(M).then((function(t){if(!t.ok)throw new Error("Failed to load HTML");return t.text()})),fetch(j).then((function(t){if(!t.ok)throw new Error("Failed to load CSS");return t.text()}))]).then((function(t){var e,r,n=(r=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,i,o,s,a=[],u=!0,c=!1;try{if(o=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;u=!1}else for(;!(u=(n=o.call(r)).done)&&(a.push(n.value),a.length!==e);u=!0);}catch(t){c=!0,i=t}finally{try{if(!u&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return a}}(e,r)||function(t,e){if(t){if("string"==typeof t)return L(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?L(t,e):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=n[0],o=n[1],s=document.documentElement,a=document.createElement("readel-extension");a.id="readel-extension";var u=a.attachShadow({mode:"open"}),c=document.createElement("style");c.textContent=o,u.appendChild(c);var h=document.createElement("div");h.innerHTML=i,u.appendChild(h),s.appendChild(a),function(t){P.apply(this,arguments)}(u)})).catch((function(t){return console.error("Failed to load resources:",t)}))})();